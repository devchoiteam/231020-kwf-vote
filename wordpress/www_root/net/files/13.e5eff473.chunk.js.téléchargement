(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1052:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=t(1294),i=(r=o)&&r.__esModule?r:{default:r};e.default=i.default},1294:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignInContainer=void 0;var r=C(t(116)),o=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(t(0)),i=t(152),a=t(437),u=t(154),s=C(t(239)),c=t(443),l=t(470),p=t(153),d=t(155),h=t(237),f=C(t(1178)),g=C(t(1133)),y=C(t(1177)),S=C(t(1176)),w=t(1194),v=t(235),m=C(t(1134)),b=C(t(94));function C(n){return n&&n.__esModule?n:{default:n}}var _,I=(_=function(n,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])})(n,e)},function(n,e){function t(){this.constructor=n}_(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),E=function(n,e,t,r){return new(t||(t=Promise))((function(o,i){function a(n){try{s(r.next(n))}catch(n){i(n)}}function u(n){try{s(r.throw(n))}catch(n){i(n)}}function s(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,u)}s((r=r.apply(n,e||[])).next())}))},P=function(n,e){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},k=t(1393),O=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={loading:!1,knownErrorRender:function(){return null}},e.renderKnownError=function(){return(0,e.state.knownErrorRender)()},e.handleFormOnChange=function(n){var t=e.props.currentCountryCode,o=(0,r.default)(n,"phone.value.countryCode");o&&o!==t&&e.props.history.replace("/"+o.toLowerCase()+"/login"),e.props.reduxActions.updateSignInFields(n)},e.handleSigninWithPhone=function(n,t){return E(e,void 0,void 0,(function(){var e,r,o,i;return P(this,(function(a){switch(a.label){case 0:e=(0,v.formatPhoneNumberForBackendParameter)(n,t,"NATIONAL"),this.showLoading(),r="",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.props.spamTokenGenerator.getTokenForAction(h.GOOGLE_RECAPTCHAV3_ACTIONS.SIGN_IN)];case 2:return r=a.sent(),[3,4];case 3:return o=a.sent(),console.error(o),[3,4];case 4:return a.trys.push([4,6,,7]),[4,this.props.requestSignInOTPV2({variables:{input:{phoneNumber:e,countryCode:t,recaptchaResponse:r}}})];case 5:return a.sent(),this.handleSigninWithPhoneSuccess(),[3,7];case 6:return i=a.sent(),this.hideLoading(),(0,d.isApolloError)(i)?this.handleSignInError(i):b.default.captureException(i),[3,7];case 7:return[2]}}))}))},e.handleSocialSignIn=function(n){return E(e,void 0,void 0,(function(){var e,t;return P(this,(function(r){switch(r.label){case 0:this.showLoading(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.props.signinPartner({variables:{provider:n.provider,identity:n.email,token:n.externalToken,countryCode:""}})];case 2:return e=r.sent(),this.handleSocialSignInSuccess(e),[3,4];case 3:return t=r.sent(),this.hideLoading(),(0,d.isApolloError)(t)?this.handleSignInError(t):b.default.captureException(t),[3,4];case 4:return[2]}}))}))},e.handleSigninWithPhoneSuccess=function(){e.hideLoading(),e.props.history.replace("/otp")},e.handleSocialSignInSuccess=function(n){e.hideLoading();var t=n.data.signinPartner,r=t.partner,o=t.token,i=t.phoneVerified;i&&o?((0,p.setToken)(o),e.props.history.replace("/application")):r&&!i&&e.props.history.replace("/otp",{partnerPhoneNumber:r.phoneNumber,partnerCountryCode:r.countryCode})},e.handleSignInError=function(n){return w.knownSignInErrorsAndWhatToRender.some((function(t){return(0,d.handleKnownErrorCodeDetected)(n,t.errorCode,(function(){return e.setState({knownErrorRender:t.render})}))}))},e}return I(e,n),e.prototype.componentDidMount=function(){this.props.reduxActions.updateFlow(h.AUTH_FLOW.SIGN_IN)},e.prototype.showLoading=function(){this.setState({loading:!0})},e.prototype.hideLoading=function(){this.setState({loading:!1})},e.prototype.render=function(){return(0,p.isAuthenticated)()?o.createElement(i.Redirect,{to:"/application"}):o.createElement("div",{className:"SignInContainer"},this.renderKnownError(),o.createElement(f.default,{countryCode:this.props.currentCountryCode,loading:this.state.loading,formState:this.props.formState,onChange:this.handleFormOnChange,onSigninWithPhone:this.handleSigninWithPhone,onSocialSignIn:this.handleSocialSignIn}),o.createElement(g.default,{className:k.marginTop}))},e}(o.PureComponent);e.SignInContainer=O;var A=(0,a.compose)((0,u.connect)((function(n){return{formState:n.form.signIn}}),(function(n){return{reduxActions:{updateCountryCode:function(e){return n((0,l.updateCountryCode)(e))},updateSignInFields:function(e){return n((0,c.updateSignInFields)(e))},updateFlow:function(e){return n((0,c.updateFlow)(e))}}}})),s.default,(0,a.graphql)(y.default,{name:"requestSignInOTPV2"}),(0,a.graphql)(S.default,{name:"signinPartner"}),m.default);e.default=A(O)},1393:function(n,e,t){n.exports={marginTop:"SignIn__marginTop___30v1m"}}}]);
//# sourceMappingURL=13.e5eff473.chunk.js.map